# Feature 1 🏋🏿‍♀️: AI Skill Lab (Personalized Skill Trainer)

---

## 1. Feature Definition

### 1.1 정의

'AI Skill Lab'은 사용자의 농구 기술 수준, 가용 장비, 훈련 시간 등의 데이터를 분석하여 최적화된 훈련 시퀀스를 설계해 주는 **개인형 지능 트레이너** 기능이다.

### 1.2 개발 배경 및 목적

- **훈련의 체계성 확보**: 동호인들이 명확한 목표 없이 반복하는 단순 연습에서 벗어나, 자신의 약점을 보완할 수 있는 과학적인 드릴(Drill)을 수행하도록 유도한다.
- **환경적 제약 사항 반영**: 골대 유무나 연습 공간의 크기 등 사용자가 처한 물리적 환경에 맞춰 '실제 실행이 가능한 훈련'만을 선별하여 제공하는 것을 목적으로 한다.

### 1.3 핵심 사용자 가치

- **개인화 (Personalization)**: 일률적인 훈련 프로그램이 아닌, 사용자 개개인의 숙련도와 필요에 맞춰진 고유한 계획을 수립한다.
- **직관적인 실행력 (Actionability)**: 복잡한 설명 대신 체크리스트 형태의 '일일 훈련 루틴 카드'를 제공하여 사용자가 즉각적으로 훈련을 시작할 수 있도록 돕는다.

### 1.4 주요 기능 범위

1. **사용자 상태 진단**: 숙련도(초보~고수), 집중 연습 분야(드리블, 슛 등), 가용 시간을 입력받아 분석한다.
2. **맞춤형 드릴 큐레이션**: 보유한 장비와 장소에 적합한 훈련 항목을 `drills.json` 데이터베이스에서 정교하게 추출한다.
3. **단계적 루틴 구성**: 웜업(Warm-up) → 메인 훈련(Main-drill) → 쿨다운(Cool-down)으로 이어지는 단계적인 워크플로우를 생성한다.

### 1.5 기대 효과

- **성장 가시화**: "Basketball is a game of details."라는 슬로건에 부합하도록, 세부적인 동작 중심의 연습을 반복하여 실질적인 기량 향상을 도모한다.
- **훈련 편의성 증대**: 훈련 메뉴 선정에 소요되는 인지적 부하를 줄여 사용자가 연습 자체에만 집중할 수 있는 환경을 조성한다.

---

## 2. Feature Implementation Specification

### 2.1 정의

'기능 구현 설계서'란 기능 정의서에서 명시한 사용자 가치를 실제 소프트웨어로 구현하기 위한 논리적 구조, 데이터 흐름, 그리고 에이전트의 동작 알고리즘을 상세히 기술한 문서이다.

### 2.2 에이전트 워크플로우

`LangGraph`를 활용하여 다중 상태를 관리하며, `CoachAgent`가 전체 프로세스를 오케스트레이션(Orchestration)한다.

| 단계 | 명칭 | 설명 |
|------|------|------|
| 1 | **State Initialization** | 사용자의 입력 데이터(약점, 가용 시간, 보유 장비)를 에이전트의 초기 상태(State)로 설정한다. |
| 2 | **Context Augmentation (RAG)** | 사용자의 요구 사항을 쿼리로 변환하여 `ChromaDB`에 저장된 `drills.json` 데이터에서 관련 훈련 항목을 검색한다. |
| 3 | **Routine Composition** | 검색된 훈련 항목들을 가용 시간에 맞춰 '웜업 → 메인 → 쿨다운' 순서로 배치한다. |
| 4 | **Refinement** | `GPT-4o`를 통해 각 훈련의 주의 사항과 코칭 팁을 추가하여 최종 'Daily Routine Card'를 생성한다. |

### 2.3 RAG 및 데이터 처리 전략

- **데이터 임베딩**: `drills.json`의 각 항목을 벡터화하여 `ChromaDB`에 저장한다.
- **시맨틱 검색 (Semantic Search)**: 사용자가 "드리블 강화"라고 입력할 경우, 'Crossover', 'Between the legs' 등 연관된 기술 태그를 가진 데이터를 벡터 유사도 기반으로 추출한다.
- **필터링 (Filtering)**: 사용자가 보유하지 않은 장비가 필요한 훈련은 검색 결과에서 제외하는 포스트 프로세싱(Post-processing)을 수행한다.

### 2.4 출력 인터페이스 규격

최종 결과물인 **Daily Routine Card**는 프론트엔드에 다음 구조의 JSON 데이터로 전달된다.

```json
{
  "routine_title": "string",
  "total_duration_min": "integer",
  "coach_message": "string",
  "drills": [
    {
      "phase": "warmup | main | cooldown",
      "drill_id": "string",
      "name": "string",
      "duration_min": "integer",
      "description": "string",
      "coaching_tip": "string"
    }
  ]
}
```

### 2.5 기술적 구성 요소

| 구성 요소 | 기술 스택 | 역할 |
|-----------|-----------|------|
| Backend Framework | `FastAPI` | 비동기적으로 에이전트의 응답을 처리한다. |
| AI Engine | `LangGraph` | 복잡한 훈련 생성 로직을 상태 기반 그래프로 제어한다. |
| Package Management | `uv` | 의존성 라이브러리를 관리하고 실행 환경의 일관성을 유지한다. |

---

## 3. Data Strategy

### 3.1 정의

'데이터 전략'이란 서비스 목적에 부합하는 데이터를 수집·구조화하고, AI 에이전트가 가장 효율적으로 탐색하여 사용자에게 최적의 답변을 제공할 수 있도록 하는 데이터 운용 체계이다.

### 3.2 데이터 저장소 구성

| 구분 | 저장소 | 설명 |
|------|--------|------|
| 원천 데이터 (Raw Data) | `data/raw/drills.json` | 훈련의 상세 설명과 메타데이터를 JSON 형식으로 저장한다. |
| 벡터 저장소 (Vector Store) | `ChromaDB` | `drills.json`의 텍스트 데이터를 임베딩하여 고차원 벡터 공간에 저장하며, 자연어 질문에 대한 시맨틱 검색을 가능하게 한다. |

### 3.3 데이터 스키마 (`drills.json`)

```json
{
  "id": "string",
  "name": "string",
  "category": "dribble | shooting | defense | conditioning",
  "difficulty": "beginner | intermediate | advanced",
  "duration_min": "integer",
  "required_equipment": ["ball", "hoop", "cones"],
  "phase": "warmup | main | cooldown",
  "description": "string",
  "tags": ["string"]
}
```

### 3.4 RAG 최적화 전략

- **메타데이터 필터링 (Metadata Filtering)**: 벡터 검색 수행 전, 사용자가 보유한 '장비'와 '가용 시간'을 기준으로 후보군을 1차 필터링하여 실행 불가능한 훈련이 추천되는 것을 방지한다.
- **하이브리드 검색 (Hybrid Search)**: 훈련의 '명칭'에 대한 키워드 매칭과 '훈련 설명'에 대한 의미론적 유사도 검색을 결합하여 검색 정확도를 높인다.
- **프롬프트 인젝션 (Prompt Injection)**: 검색된 훈련 데이터를 LLM에 전달할 때, 사용자의 현재 약점을 보완할 수 있는 관점에서 설명하라는 지시어를 포함하여 개인화된 메시지를 생성한다.

### 3.5 샘플 데이터

| # | 훈련명 | 설명 | 난이도 | 필요 장비 |
|---|--------|------|--------|-----------|
| 1 | 마이칸 드릴 | 골대 하단에서 양손 레이업을 반복하여 감각을 익히는 기초 훈련 | Beginner | 공, 골대 |
| 2 | 포인트 콘 드리블 | 콘을 배치하고 가랑이 사이로 공을 통과시키는 중급 훈련 | Intermediate | 공, 콘 |
| 3 | 캐치 앤 슛 | 패스를 받아 즉각적으로 슛을 시도하는 슈터용 훈련 | Intermediate | 공, 골대 |

---

## 4. Wireframe

### 4.1 정의

'와이어프레임'이란 소프트웨어의 화면 구조를 단순한 선과 도형으로 시각화하여, 기능의 배치와 사용자 흐름(User Flow)을 설계하는 설계도이다.

### 4.2 레이아웃 구조

모바일 우선(Mobile-First) 환경을 고려하여 직관적인 싱글 페이지 레이아웃으로 구성한다.

```
┌─────────────────────────────┐
│  Header: Assist | AI Skill Lab │
├─────────────────────────────┤
│                             │
│    Input Section (Wizard)   │
│  · 집중 분야 선택            │
│  · 훈련 환경 필터            │
│  · 가용 시간 입력            │
│  [ 루틴 생성하기 버튼 ]       │
│                             │
├─────────────────────────────┤
│                             │
│   Daily Routine Card        │
│  ─────────────────────────  │
│  AI Coaching Banner         │
│  ─────────────────────────  │
│  [ ] Warm-up: 마이칸 드릴   │
│  [ ] Main: 포인트 콘 드리블  │
│  [ ] Cool-down: 스트레칭     │
│                             │
├─────────────────────────────┤
│  🏋️ Skill Lab │ 👟 Gear │ 📏 Whistle │
└─────────────────────────────┘
```

### 4.3 주요 컴포넌트

`Shadcn/UI`와 `TailwindCSS`를 활용하여 구현한다.

**훈련 설정 위젯 (Setup Widget)**
- '집중 분야' 선택: 드롭다운 또는 버튼 그룹 형태
- '훈련 환경' 필터: 장비(공, 골대 등) 및 시간(분 단위) 입력 폼

**일일 훈련 루틴 카드 (Daily Routine Card)**
- 헤더: 루틴 명칭과 총 소요 시간 요약 표시
- 체크리스트: 개별 훈련 항목과 완료 여부를 체크할 수 있는 체크박스
- 상세 보기: 각 항목 클릭 시 훈련 방법을 확인할 수 있는 아코디언(Accordion) UI

**AI 코칭 배너 (AI Coaching Banner)**
- `CoachAgent`가 생성한 개인 맞춤형 조언과 주의 사항을 강조된 텍스트 박스로 노출

### 4.4 사용자 흐름 (User Flow)

```
상태 입력 → 루틴 생성 요청 → 루틴 확인 및 실행 → 결과 요약
```

1. **상태 입력**: 사용자가 자신의 약점과 현재 처한 환경 데이터를 입력한다.
2. **루틴 생성 요청**: '루틴 생성하기' 버튼을 클릭하여 `CoachAgent`에게 연산을 요청한다.
3. **루틴 확인 및 실행**: 화면에 출력된 체크리스트를 따라 훈련을 수행하고 완료된 항목을 체크한다.
4. **결과 요약**: 모든 훈련 완료 후 최종 성과를 확인한다.

### 4.5 디자인 가이드라인

- **가독성**: 훈련 중에도 쉽게 읽을 수 있도록 큰 폰트와 명확한 대비를 사용한다.
- **간결성**: 'Vibe Coding' 전략에 따라 복잡한 그래픽보다는 `Shadcn/UI`의 기본 컴포넌트를 활용하여 개발 속도를 높인다.

---

## 5. Test Cases

### 5.1 정의

'테스트 케이스(Test Cases)'란 소프트웨어의 특정 기능이나 시나리오가 설계된 사양에 따라 정확하게 동작하는지 확인하기 위해 작성된 입력값, 실행 조건, 그리고 예상 결과의 집합이다.

### 5.2 테스트 목적 및 범위

- **목적**: `CoachAgent`가 사용자의 입력 조건(약점, 시간, 장비)에 부합하는 최적의 훈련 루틴을 생성하고, 이를 UI에 정확히 출력하는지 검증한다.
- **범위**: 훈련 데이터 검색(RAG)의 정확성, 가용 시간 배분의 적절성, 사용자 인터페이스(체크리스트)의 상호작용을 포함한다.

### 5.3 세부 테스트 시나리오

| ID | 시나리오 | 입력 조건 | 기대 결과 |
|----|----------|-----------|-----------|
| TC-01 | 정상 루틴 생성 | 약점: 드리블, 시간: 30분, 장비: 공만 보유 | 골대 불필요 드릴로만 구성된 루틴 반환 |
| TC-02 | 장비 필터링 검증 | 장비: 공만 보유 (골대 없음) | 골대 필요 드릴이 결과에 포함되지 않음 |
| TC-03 | 시간 배분 검증 | 시간: 20분 | 웜업+메인+쿨다운 합계가 20분 이내 |
| TC-04 | 예외 처리 | 유효하지 않은 입력값 | 적절한 오류 메시지 반환 |
| TC-05 | UI 체크리스트 인터랙션 | 훈련 항목 체크 | 체크 상태 변경 및 완료 항목 시각적 처리 |

### 5.4 통과 기준 (Success Criteria)

1. **데이터 무결성**: 추천된 모든 훈련 항목은 `drills.json`에 존재하는 실제 데이터여야 한다.
2. **논리적 일치**: 사용자가 선택한 '집중 분야'와 실제 추천된 훈련의 '카테고리'가 논리적으로 일치해야 한다.
3. **응답 속도**: 사용자의 입력 후 'Daily Routine Card'가 화면에 출력되기까지의 시간이 서비스 허용 범위 내에 있어야 한다.

### 5.5 결함 관리

테스트 과정에서 발견된 오류는 'Vibe Coding' 전략에 따라 즉시 에이전트에게 피드백하여 코드를 수정하고, 재테스트를 거쳐 최종 확정한다.
