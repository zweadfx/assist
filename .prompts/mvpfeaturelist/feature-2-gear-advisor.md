# Feature 2 👟: Gear Advisor (Sensory-based Recommendation)

---

## 1. Feature Definition

### 1.1 정의

'Gear Advisor'는 사용자의 '감각적 선호(Sensory Preference)'와 '선수 아키타입(Player Archetype)'을 분석하여, 단순한 제원 비교를 넘어선 최적의 농구화를 제안하는 **지능형 장비 추천** 기능이다.

### 1.2 개발 배경 및 목적

- **정성적 데이터 기반 추천**: 기존의 무게나 가격과 같은 단순 수치 비교가 아닌, '접지 소리'나 '쿠션의 밀도' 등 사용자가 경기 중 직접 체감하는 '감각적 요소'를 충족시키는 장비를 추천하는 것을 목적으로 한다.
- **플레이 스타일 최적화**: 사용자가 지향하는 '워너비 선수'의 플레이 스타일을 분석하고, 해당 스타일에 필요한 기능적 특성을 갖춘 농구화를 연결하여 전문적인 선택을 지원한다.

### 1.3 핵심 사용자 가치

- **감각적 만족 (Sensory Satisfaction)**: 사용자가 중요하게 생각하는 세밀한 감각적 니즈를 파악하여, 개인의 취향에 최적화된 장비를 소유하는 즐거움을 제공한다.
- **정보의 신뢰성 (Reliability)**: RAG 기술을 통해 `shoes.json` 및 `players.json`에 기반한 명확한 데이터 근거를 제시함으로써 추천 결과에 대한 신뢰도를 높인다.

### 1.4 주요 기능 범위

1. **사용자 취향 진단**: '쿠션감', '접지력', '발목 지지력' 등 사용자가 선호하는 핵심 감각 키워드를 수집한다.
2. **선수 아키타입 매칭**: 선호하는 선수의 스타일(예: "스테픈 커리")을 입력받아 해당 선수의 플레이 특성과 장비 요구 사항을 분석한다.
3. **지능형 결과 도출**: 벡터 DB(`ChromaDB`)를 통해 입력된 감각 태그와 가장 유사한 제품 정보를 검색하고, 맞춤형 추천 사유를 생성한다.

### 1.5 기대 효과

- **합리적 소비 유도**: 개인의 실제 감각과 어긋나는 잘못된 장비 구매를 방지하여 장비 선택의 시행착오를 줄인다.
- **전문성 강화**: 'Assist' 서비스의 철학인 'Basketball is a game of details'를 실현하여 사용자가 세밀한 장비의 차이를 이해하고 활용하게 돕는다.

---

## 2. Feature Implementation Specification

### 2.1 정의

'기능 구현 설계서'란 'Gear Advisor'가 사용자의 감각적 요구사항을 분석하여 최적의 제품을 검색하고, 이를 개인화된 추천 근거와 함께 제공하기 위한 기술적 구현 경로와 에이전트의 논리적 절차를 명시한 문서를 의미한다.

### 2.2 에이전트 워크플로우

`LangGraph`를 통해 `ShoeAgent`를 제어하며, 다음과 같은 단계로 상호작용을 처리한다.

| 단계 | 명칭 | 설명 |
|------|------|------|
| 1 | **State Setup** | 사용자가 선택한 '감각 태그(쿠션감, 접지음 등)'와 '워너비 선수(선수 아키타입)'를 시스템의 입력 상태로 수용한다. |
| 2 | **Query Generation** | 사용자의 추상적인 감각 표현을 `ChromaDB` 검색이 가능한 '기술적 키워드'로 변환한다. |
| 3 | **RAG Search** | `shoes.json`에서 추출된 벡터 데이터를 기반으로 유사도가 높은 상위 농구화 모델을 추출한다. |
| 4 | **Archetype Matching** | `players.json`의 정보를 바탕으로, 선택된 농구화가 해당 선수의 플레이 스타일과 어떻게 부합하는지 분석한다. |
| 5 | **Reasoning** | `GPT-4o`가 검색된 모든 데이터를 종합하여 사용자에게 전달할 '설득력 있는 추천 메시지'를 생성한다. |

### 2.3 RAG 및 검색 고도화 전략

단순한 텍스트 매칭을 넘어선 감각 중심의 검색을 위해 다음 기법을 적용한다.

- **감각 벡터화 (Sensory Embedding)**: '쫀득한 접지', '단단한 쿠션'과 같은 정성적 표현을 임베딩하여 유사한 성능의 제품을 탐색한다.
- **선수 연관 검색**: 특정 선수의 시그니처 모델뿐만 아니라, 그 선수와 유사한 스타일의 선수가 착용하는 모델군까지 검색 범위를 확장한다.
- **다중 필터링**: `ChromaDB` 검색 결과 중 사용자의 '최우선 감각 순위'에 가장 부합하는 제품을 상단에 배치하는 포스트 프로세싱(Post-processing)을 수행한다.

### 2.4 출력 인터페이스 규격

최종 결과물인 **Recommendation Card**는 프론트엔드에 다음 구조의 JSON 데이터로 전달된다.

```json
{
  "recommendation_title": "string",
  "user_profile_summary": "string",
  "ai_reasoning": "string",
  "shoes": [
    {
      "shoe_id": "string",
      "brand": "string",
      "model_name": "string",
      "sensory_tags": ["string"],
      "player_archetype": "string",
      "match_score": "integer",
      "recommendation_reason": "string",
      "image_url": "string"
    }
  ]
}
```

### 2.5 기술적 구성 요소

| 구성 요소 | 기술 스택 | 역할 |
|-----------|-----------|------|
| Backend Framework | `FastAPI` | 비동기적으로 `ShoeAgent`의 응답을 처리한다. |
| AI Engine | `LangGraph` | 사용자 입력 분석부터 최종 결과 생성까지의 워크플로우를 상태 기반으로 관리한다. |
| Vector Database | `ChromaDB` | `shoes.json` 및 `players.json` 데이터를 관리하고 검색한다. |
| Package Management | `uv` | 의존성 라이브러리를 관리하고 실행 환경의 일관성을 유지한다. |

---

## 3. Data Strategy

### 3.1 정의

'데이터 전략'이란 사용자의 주관적인 감각 선호도와 선수들의 플레이 스타일 데이터를 체계적으로 구조화하여, AI 에이전트가 최적의 장비를 선별할 수 있도록 지원하는 데이터 운용 계획을 의미한다.

### 3.2 데이터 구성 및 관리

장비 추천의 정확도를 높이기 위해 두 가지 핵심 원천 데이터를 병행하여 관리한다.

| 구분 | 저장소 | 설명 |
|------|--------|------|
| 농구화 데이터 | `data/raw/shoes.json` | 제품의 물리적 제원뿐만 아니라 사용자가 체감하는 '감각 태그'를 포함하는 핵심 데이터셋이다. |
| 선수 아키타입 데이터 | `data/raw/players.json` | 유명 농구 선수들의 플레이 스타일과 그들이 선호하는 장비 특성을 정의한 데이터셋이다. |
| 벡터 저장소 | `ChromaDB` | 자연어 기반의 감각 표현을 벡터화하여 저장함으로써 고도화된 유사도 검색(RAG)을 지원한다. |

### 3.3 데이터 스키마 상세

#### 3.3.1 농구화 데이터 스키마 (`shoes.json`)

제품의 감각적 특성을 정량화하기 위해 다음과 같은 구조를 유지한다.

```json
{
  "id": "string",
  "brand": "string",
  "model_name": "string",
  "release_year": "integer",
  "price_krw": "integer",
  "weight_g": "integer",
  "sensory_tags": ["최상급 접지", "반발성 쿠션", "가벼운 무게"],
  "cushion_type": "zoom | boost | react | other",
  "support_level": "low | mid | high",
  "traction_pattern": "string",
  "player_signature": "string",
  "description": "string",
  "tags": ["string"]
}
```

#### 3.3.2 선수 아키타입 스키마 (`players.json`)

사용자의 '워너비 선수'를 분석하기 위한 데이터 구조이다.

```json
{
  "id": "string",
  "name": "string",
  "position": "guard | forward | center",
  "play_style": ["정교한 핸들링", "오프볼 무브", "빠른 릴리즈"],
  "signature_shoes": ["string"],
  "preferred_features": {
    "cushion": "soft | firm | responsive",
    "support": "low | mid | high",
    "traction": "aggressive | moderate | minimal"
  },
  "description": "string"
}
```

### 3.4 RAG 최적화 전략

- **감각 키워드 임베딩**: 사용자가 입력한 "구름 위를 걷는 듯한 느낌"과 같은 표현을 벡터화하여, `shoes.json`의 `sensory_tags` 중 가장 유사한 의미를 가진 제품을 검색한다.
- **교차 분석 알고리즘**: `ShoeAgent`는 검색된 제품 리스트를 `players.json`의 스타일 정보와 대조하여, 사용자가 지향하는 선수 스타일에 가장 부합하는 최종 후보군을 선별한다.
- **데이터 지속성**: 새로운 농구화 모델 출시 시, `uv` 및 패키지 관리 도구를 활용하여 원천 데이터를 갱신하고 `ChromaDB`의 인덱스를 자동으로 업데이트하는 파이프라인을 구축한다.

### 3.5 샘플 데이터

| # | 모델명 | 브랜드 | 감각 태그 | 연관 선수 |
|---|--------|--------|-----------|-----------|
| 1 | Nike Kobe 6 Protro | Nike | 최상급 접지, 반발성 쿠션, 가벼운 무게 | Kobe Bryant |
| 2 | Adidas Harden Vol. 7 | Adidas | 부드러운 쿠션, 안정적인 지지 | James Harden |
| 3 | Under Armour Curry 10 | Under Armour | 정교한 접지, 민첩한 무브 | Stephen Curry |

---

## 4. Wireframe

### 4.1 정의

'와이어프레임'이란 소프트웨어의 시각적 디자인 요소를 배제하고, 화면의 골격, 기능의 배치, 그리고 사용자의 이동 경로를 선과 상자로 시각화한 설계도를 의미한다.

### 4.2 레이아웃 구조

본 기능은 사용자가 자신의 선호도를 단계적으로 입력하고 직관적인 추천 결과를 받아볼 수 있도록 'Step-by-Step' 인터페이스를 채택한다.

```
┌─────────────────────────────┐
│  Header: Assist | Gear Advisor │
├─────────────────────────────┤
│                             │
│  Step 1: Sensory Input      │
│  ─────────────────────────  │
│  [ ] 쫀득한 접지             │
│  [ ] 구름 같은 쿠션          │
│  [ ] 단단한 발목 지지        │
│                             │
├─────────────────────────────┤
│                             │
│  Step 2: Player Archetype   │
│  ─────────────────────────  │
│  [ Stephen Curry ]          │
│  [ LeBron James ]           │
│  [ Kobe Bryant ]            │
│                             │
├─────────────────────────────┤
│  [ 추천받기 버튼 ]           │
├─────────────────────────────┤
│                             │
│  Step 3: Recommendation     │
│  ─────────────────────────  │
│  AI Reasoner Banner         │
│  ─────────────────────────  │
│  📦 Nike Kobe 6 Protro      │
│     💬 추천 사유             │
│  📦 Under Armour Curry 10   │
│     💬 추천 사유             │
│                             │
├─────────────────────────────┤
│  🏋️ Skill Lab │ 👟 Gear │ 📏 Whistle │
└─────────────────────────────┘
```

### 4.3 주요 컴포넌트

`Shadcn/UI`와 `TailwindCSS`를 기반으로 신속하게 구현 가능한 표준 컴포넌트를 활용한다.

**감각 키워드 칩 (Sensory Chip Group)**
- '삐걱거리는 접지', '구름 같은 쿠션' 등 감각 태그를 다중 선택할 수 있는 토글 그룹(Toggle Group) 컴포넌트이다.

**선수 카드 그리드 (Player Selection Grid)**
- 각 선수의 이름과 스타일 아이콘이 포함된 카드형 선택 도구이다.

**추천 사유 배너 (AI Reasoner Banner)**
- "이 농구화는 당신이 선호하는 '쫀득한 접지력'을 제공하며, '스테픈 커리'처럼 빠른 방향 전환이 잦은 스타일에게 적합합니다"와 같은 AI 생성 텍스트를 강조하여 표시한다.

**제품 상세 카드 (Shoe Info Card)**
- 제품 이미지 홀더, 모델명, 브랜드, 그리고 핵심 감각 태그들을 배지(Badge) 형태로 포함한다.

### 4.4 사용자 흐름

```
진입 → 선호 입력 → 스타일 지정 → 결과 확인
```

1. **진입**: 하단 내비게이션에서 'Gear Advisor' 탭을 선택하여 진입한다.
2. **선호 입력**: 제공된 감각 키워드 중 본인의 취향에 맞는 항목들을 선택한다.
3. **스타일 지정**: 자신이 닮고 싶은 선수의 아키타입을 선택한다.
4. **결과 확인**: '추천받기' 버튼을 클릭하여 `ShoeAgent`가 생성한 개인화된 농구화 리스트와 상세 사유를 확인한다.

### 4.5 디자인 가이드라인

- **일관성**: 전체 프로젝트 슬로건인 "Basketball is a game of details."의 정체성을 유지하기 위해 깔끔하고 전문적인 타이포그래피를 사용한다.
- **반응형 설계**: 모바일 환경에서의 조작 편의성을 위해 클릭 가능한 요소들의 크기를 충분히 확보한다.
- **간결성**: 'Vibe Coding' 전략에 따라 복잡한 그래픽보다는 `Shadcn/UI`의 기본 컴포넌트를 활용하여 개발 속도를 높인다.

---

## 5. Test Cases

### 5.1 정의

'테스트 케이스(Test Cases)'란 특정 기능이 설계 사양에 부합하게 동작하는지 확인하기 위해 작성된 입력값, 실행 조건, 그리고 예상 결과의 집합을 의미한다.

### 5.2 테스트 목적 및 범위

- **목적**: `ShoeAgent`가 사용자의 '감각적 선호'와 '선수 아키타입'을 정확히 분석하여, `shoes.json` 데이터에 기반한 최적의 농구화 추천 결과를 생성하는지 검증한다.
- **범위**: 감각 태그 기반의 벡터 검색(RAG) 정확도, 선수 스타일과의 매칭 논리, AI가 생성한 추천 사유의 타당성을 포함한다.

### 5.3 세부 테스트 시나리오

| ID | 시나리오 | 입력 조건 | 기대 결과 |
|----|----------|-----------|-----------|
| TC-01 | 정상 추천 생성 | 감각: 쫀득한 접지, 선수: Stephen Curry | Curry와 관련된 농구화 및 접지력 우수 제품 반환 |
| TC-02 | 감각 태그 필터링 검증 | 감각: 구름 같은 쿠션 | 쿠션 특화 제품만 결과에 포함 |
| TC-03 | 선수 아키타입 매칭 | 선수: LeBron James | LeBron 시그니처 또는 유사 스타일 제품 추천 |
| TC-04 | 복합 조건 검색 | 감각: 단단한 지지 + 선수: Kawhi Leonard | 두 조건을 모두 만족하는 제품 우선 배치 |
| TC-05 | 예외 처리 | 선택 항목 없음 | 적절한 오류 메시지 또는 기본 추천 제공 |
| TC-06 | UI 인터랙션 | 추천 카드 클릭 | 제품 상세 정보 모달 또는 페이지 표시 |

### 5.4 통과 기준

1. **데이터 신뢰성**: 추천된 모든 제품 정보는 `shoes.json`의 원천 데이터와 일치해야 한다.
2. **검색 유효성**: 상위 3개의 추천 리스트는 사용자가 입력한 감각 태그와 최소 70% 이상의 의미론적 유사도를 가져야 한다.
3. **UI 정합성**: 추천 결과가 '와이어프레임'에서 설계한 '추천 카드'의 형식을 준수하여 깨짐 없이 출력되어야 한다.
4. **응답 속도**: 사용자의 입력 후 'Recommendation Card'가 화면에 출력되기까지의 시간이 서비스 허용 범위 내에 있어야 한다.

### 5.5 결함 관리

'Vibe Coding' 전략에 따라 테스트 중 발견된 검색 품질 저하 문제는 `ShoeAgent`의 시스템 프롬프트를 수정하거나, `ChromaDB`의 임베딩 로직을 조정하여 즉시 해결한다.

---
